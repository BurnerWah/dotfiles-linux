#autoload
# vim:fileencoding=utf-8:ft=zsh:foldmethod=indent:foldlevel=1
setopt local_options pipe_fail 2> /dev/null

#local dir=$(eval "$find_cmd" | \
local dir=$( fd -LH -td $( zstyle -t ':zle:cd-widget' flags 'color' && echo '-c always' ) | \
  fzf +m --height 40% --reverse $( zstyle -t ':zle:cd-widget' flags 'color' && echo '--ansi' ) )

if [[ -z "$dir" ]] {
  zle redisplay
  return 0
}

cd "$dir"

local ret=$?

zle redraw-prompt

return $ret
